#include "ManufacturedFunction.h"

registerMooseObject("egretApp", RHSFunc);

InputParameters
RHSFunc::validParams()
{
  auto params = Function::validParams();
  params.addRequiredParam<Real>("alpha", "Parameter");
  params.addRequiredParam<Real>("m", "Parameter");
  params.addRequiredParam<Real>("epsilon", "Parameter");
  return params;
}

RHSFunc::RHSFunc(InputParameters const & params)
  : Function(params),
    _alpha(getParam<Real>("alpha")),
    _m(getParam<Real>("m")),
    _epsilon(getParam<Real>("epsilon"))
{
}

Real
RHSFunc::value(Real t, const Point & p) const
{
  auto x = p(0);
  auto y = p(1);
  auto epsilon = _epsilon;
  auto alpha = _alpha;
  auto m = _m;

  auto ans =  -std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*(1 - epsilon)*(2*y - 1)*(std::pow(y, 2) - y)*(M_PI*epsilon*std::cos(2*M_PI*x)*std::cos(M_PI*y) + (alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*std::cos(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y))*std::pow(std::sin(M_PI*m*x), 2)/(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2) + std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2)) + 2*M_PI*std::pow(alpha, 2)*m*(1 - epsilon)*(std::pow(y, 2) - y)*(-M_PI*alpha*m*(std::pow(y, 2) - y)*std::sin(M_PI*m*x)*std::cos(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y) - 2*M_PI*epsilon*std::sin(2*M_PI*x)*std::sin(M_PI*y))*std::sin(M_PI*m*x)*std::cos(M_PI*m*x)/(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2) + std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2)) + std::pow(M_PI, 2)*alpha*std::pow(m, 2)*(1 - epsilon)*(std::pow(y, 2) - y)*(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*(M_PI*epsilon*std::cos(2*M_PI*x)*std::cos(M_PI*y) + (alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*std::cos(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y))*std::cos(M_PI*m*x)/(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2) + std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2)) + M_PI*alpha*m*(1 - epsilon)*(2*y - 1)*(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*(-M_PI*alpha*m*(std::pow(y, 2) - y)*std::sin(M_PI*m*x)*std::cos(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y) - 2*M_PI*epsilon*std::sin(2*M_PI*x)*std::sin(M_PI*y))*std::sin(M_PI*m*x)/(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2) + std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2)) + M_PI*alpha*m*(1 - epsilon)*(std::pow(y, 2) - y)*(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*(M_PI*epsilon*std::cos(2*M_PI*x)*std::cos(M_PI*y) + (alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*std::cos(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y))*(-2*std::pow(M_PI, 3)*std::pow(alpha, 2)*std::pow(m, 3)*std::pow(std::pow(y, 2) - y, 2)*std::sin(M_PI*m*x)*std::cos(M_PI*m*x) + 2*M_PI*alpha*m*(2*y - 1)*(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*std::sin(M_PI*m*x))*std::sin(M_PI*m*x)/std::pow(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2) + std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2), 2) + 2*M_PI*alpha*m*(1 - epsilon)*(std::pow(y, 2) - y)*(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*(-M_PI*alpha*m*(2*y - 1)*std::sin(M_PI*m*x)*std::cos(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y) + M_PI*alpha*m*(std::pow(y, 2) - y)*(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*std::sin(M_PI*m*x)*std::sin(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y) - 2*std::pow(M_PI, 2)*epsilon*std::sin(2*M_PI*x)*std::cos(M_PI*y))*std::sin(M_PI*m*x)/(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2) + std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2)) + M_PI*alpha*m*(1 - epsilon)*(std::pow(y, 2) - y)*(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*(-M_PI*alpha*m*(std::pow(y, 2) - y)*std::sin(M_PI*m*x)*std::cos(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y) - 2*M_PI*epsilon*std::sin(2*M_PI*x)*std::sin(M_PI*y))*(-std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*(4*y - 2)*(std::pow(y, 2) - y)*std::pow(std::sin(M_PI*m*x), 2) - 4*alpha*(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*std::cos(M_PI*m*x))*std::sin(M_PI*m*x)/std::pow(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2) + std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2), 2) + (epsilon + (1 - epsilon)*std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2)/(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2) + std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2)))*(-std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2)*std::sin(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y) - std::pow(M_PI, 2)*alpha*std::pow(m, 2)*(std::pow(y, 2) - y)*std::cos(M_PI*m*x)*std::cos(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y) - 4*std::pow(M_PI, 2)*epsilon*std::sin(M_PI*y)*std::cos(2*M_PI*x)) + (M_PI*epsilon*std::cos(2*M_PI*x)*std::cos(M_PI*y) + (alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*std::cos(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y))*(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*(1 - epsilon)*(4*y - 2)*(std::pow(y, 2) - y)*std::pow(std::sin(M_PI*m*x), 2)/(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2) + std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2)) + std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*(1 - epsilon)*std::pow(std::pow(y, 2) - y, 2)*(-std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*(4*y - 2)*(std::pow(y, 2) - y)*std::pow(std::sin(M_PI*m*x), 2) - 4*alpha*(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*std::cos(M_PI*m*x))*std::pow(std::sin(M_PI*m*x), 2)/std::pow(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2) + std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2), 2)) + (-M_PI*alpha*m*(std::pow(y, 2) - y)*std::sin(M_PI*m*x)*std::cos(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y) - 2*M_PI*epsilon*std::sin(2*M_PI*x)*std::sin(M_PI*y))*(-2*M_PI*alpha*m*(1 - epsilon)*(2*y - 1)*(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*std::sin(M_PI*m*x)/(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2) + std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2)) + (1 - epsilon)*std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2)*(-2*std::pow(M_PI, 3)*std::pow(alpha, 2)*std::pow(m, 3)*std::pow(std::pow(y, 2) - y, 2)*std::sin(M_PI*m*x)*std::cos(M_PI*m*x) + 2*M_PI*alpha*m*(2*y - 1)*(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI)*std::sin(M_PI*m*x))/std::pow(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2) + std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2), 2)) + (std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*(1 - epsilon)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2)/(std::pow(M_PI, 2)*std::pow(alpha, 2)*std::pow(m, 2)*std::pow(std::pow(y, 2) - y, 2)*std::pow(std::sin(M_PI*m*x), 2) + std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2)) + epsilon)*(2*alpha*std::cos(M_PI*m*x)*std::cos(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y) - std::pow(M_PI, 2)*epsilon*std::sin(M_PI*y)*std::cos(2*M_PI*x) - std::pow(alpha*(2*y - 1)*std::cos(M_PI*m*x) + M_PI, 2)*std::sin(alpha*(std::pow(y, 2) - y)*std::cos(M_PI*m*x) + M_PI*y));
  return -ans;
} 
